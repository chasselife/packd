<h2 mat-dialog-title>{{ isEditMode ? 'Edit Checklist' : 'Create New Checklist' }}</h2>

<mat-dialog-content>
  <form [formGroup]="form" class="flex flex-col gap-4 pt-4">
    <mat-form-field appearance="outline">
      <mat-label>Title</mat-label>
      <input matInput formControlName="title" placeholder="Enter checklist title" />
      @if (form.get('title')?.hasError('required') && form.get('title')?.touched) {
      <mat-error>Title is required</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Icon</mat-label>
      <mat-select formControlName="icon">
        <mat-select-trigger>
          @if (getSelectedIcon(); as selectedIcon) {
          <div class="flex items-center gap-2">
            <mat-icon>{{ selectedIcon.value }}</mat-icon>
            <span>{{ selectedIcon.label }}</span>
          </div>
          }
        </mat-select-trigger>
        @for (icon of icons; track icon.value) {
        <mat-option [value]="icon.value">
          <div class="flex items-center gap-2">
            <mat-icon>{{ icon.value }}</mat-icon>
            <span>{{ icon.label }}</span>
          </div>
        </mat-option>
        }
      </mat-select>
      @if (form.get('icon')?.hasError('required') && form.get('icon')?.touched) {
      <mat-error>Icon is required</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Color</mat-label>
      <mat-select formControlName="color">
        <mat-select-trigger>
          @if (getSelectedColor(); as selectedColor) {
          <div class="flex items-center gap-2">
            <div
              class="w-6 h-6 rounded-full border-2"
              [style.background-color]="selectedColor.value"
              [style.border-color]="selectedColor.value"
            ></div>
            <span>{{ selectedColor.label }}</span>
          </div>
          }
        </mat-select-trigger>
        @for (color of colorOptions; track color.value) {
        <mat-option [value]="color.value">
          <div class="flex items-center gap-2">
            <div
              class="w-6 h-6 rounded-full border-2"
              [style.background-color]="color.value"
              [style.border-color]="color.value"
            ></div>
            <span>{{ color.label }}</span>
          </div>
        </mat-option>
        }
      </mat-select>
      @if (form.get('color')?.hasError('required') && form.get('color')?.touched) {
      <mat-error>Color is required</mat-error>
      }
    </mat-form-field>
  </form>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <div class="mb-4 mr-4">
    <button mat-button (click)="onCancel()">Cancel</button>
    <button
      mat-raised-button
      color="primary"
      (click)="isEditMode ? onSave() : onCreate()"
      [disabled]="!form.valid"
    >
      {{ isEditMode ? 'Save' : 'Create' }}
    </button>
  </div>
</mat-dialog-actions>
